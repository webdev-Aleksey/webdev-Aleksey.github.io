!function(r){function s(t,i){this.container=r(t),this.settings=i,this.timer=0,this.before={v:0,h:0},this.touch={},this.pressed=0,this.vslider=r("<div/>",{class:"scrollbar-handle"}),this.vpath=r("<div/>",{class:"scrollbar-path-vertical"}),this.hslider=r("<div/>",{class:"scrollbar-handle"}),this.hpath=r("<div/>",{class:"scrollbar-path-horizontal"}),this.sliders=this.vslider.add(this.hslider),this.container.css({overflow:"hidden",position:"relative"}).contents().filter(this.settings.contentFilter).wrapAll('<div class="scrollbar-content"></div>'),this.content=this.container.children(".scrollbar-content").css({top:0,left:0,position:"relative",float:"left"}),"horizontal"==this.settings.scroll?this.container.prepend(this.hpath.append(this.hslider)):"vertical"==this.settings.scroll?this.container.prepend(this.vpath.append(this.vslider)):this.container.prepend(this.vpath.append(this.vslider),this.hpath.append(this.hslider)),this.vpath.add(this.hpath).css({"z-index":this.settings.zIndex,display:"none"}),this.vslider.css({height:this.settings.sliderSize,opacity:this.settings.sliderOpacity}),this.hslider.css({width:this.settings.sliderSize,opacity:this.settings.sliderOpacity}),this.settings.sliderOpacity&&this.sliders.hover(this.fixFn(function(){this.sliders.stop().fadeTo(this.settings.sliderOpacityTime,1)}),this.fixFn(function(){this.pressed||this.sliders.stop().fadeTo(this.settings.sliderOpacityTime,this.settings.sliderOpacity)})),this.init(),this.pathSize(),this.bindEvent(r(window),"load",function(){setTimeout(this.fixFn(this.checkScroll),10)}),0<this.settings.lazyCheckScroll&&setInterval(this.fixFn(this.checkScroll),this.settings.lazyCheckScroll)}s.prototype.checkScroll=function(){this.vtrack=this.vpath.height()-this.vslider.height(),this.htrack=this.hpath.width()-this.hslider.width(),this.vdiff=this.content.height()-this.container.height(),this.hdiff=this.content.width()-this.container.width(),this.settings.autoHide&&(0<this.vdiff?this.vpath.fadeIn(this.settings.autoHideTime):this.vpath.fadeOut(this.settings.autoHideTime),0<this.hdiff?this.hpath.fadeIn(this.settings.autoHideTime):this.hpath.fadeOut(this.settings.autoHideTime))},s.prototype.pathSize=function(){var t=parseInt(this.settings.pathPadding,10);this.vpath.css({top:t+"px",height:this.container.height()-2*t+"px"}),this.hpath.css({left:t+"px",width:this.container.width()-2*t+"px"})},s.prototype.scroll=function(t,i,s){var e=0,h=0;t<0&&(t=0),t>this.vtrack&&(t=this.vtrack),this.vslider.css("top",t+"px"),i<0&&(i=0),i>this.htrack&&(i=this.htrack),this.hslider.css("left",i+"px"),0<this.vdiff&&(h=t/this.vtrack,this.content.css("top",Math.round(-this.vdiff*h)),s&&t&&t!=this.vtrack&&(s.stopPropagation(),s.preventDefault())),0<this.hdiff&&(e=i/this.htrack,this.content.css("left",Math.round(-this.hdiff*e)),s&&i&&i!=this.htrack&&(s.stopPropagation(),s.preventDefault())),this.before.v==h&&this.before.h==e||("function"==typeof this.settings.onscroll&&this.settings.onscroll.call(this.container.get(0),h,e),this.before.v=h,this.before.h=e)},s.prototype.easeScroll=function(t,i){var s=0,e=Math.floor(this.settings.scrollTime/this.settings.scrollInterval),h=this.vslider.position().top,n=this.hslider.position().left,o=r.easing[this.settings.scrollEasing]||r.easing.linear;this.sliders.stop().fadeTo(this.settings.sliderOpacityTime,1),window.clearInterval(this.timer),this.timer=window.setInterval(this.fixFn(function(){this.scroll(h+o(s/e,s,0,1,e)*t,n+o(s/e,s,0,1,e)*i),++s>e&&(window.clearInterval(this.timer),this.sliders.stop().fadeTo(this.settings.sliderOpacityTime,this.settings.sliderOpacity))}),this.settings.scrollInterval)},s.prototype.fixFn=function(t,i){var s=this;return function(){t.apply(i||s,Array.prototype.slice.call(arguments))}},s.prototype.bindEvent=function(t,i,s,e){return t.bind(i,this.fixFn(s,e))},s.prototype.init=function(){var n=r(window.document);this.bindEvent(this.sliders,"mousedown",function(t){this.pressed=t.target===this.vslider.get(0)?1:2;var i=t.pageX,s=t.pageY,e=this.vslider.position().top,h=this.hslider.position().left;this.bindEvent(n,"mousemove",function(t){1==this.pressed?this.scroll(e+(t.pageY-s),h):this.scroll(e,h+(t.pageX-i))}),this.bindEvent(n,"selectstart",function(t){t.preventDefault()})}),this.bindEvent(n,"mouseup",function(t){1==this.pressed&&t.target!==this.vslider.get(0)?this.vslider.fadeTo(this.settings.sliderOpacityTime,this.settings.sliderOpacity):2==this.pressed&&t.target!==this.hslider.get(0)&&this.hslider.fadeTo(this.settings.sliderOpacityTime,this.settings.sliderOpacity),this.pressed=0,n.unbind("mousemove"),n.unbind("selectstart")}),this.bindEvent(this.container,"touchstart",function(t){var i=t.originalEvent,s=i.changedTouches[0];this.touch.sx=s.pageX,this.touch.sy=s.pageY,this.touch.sv=this.vslider.position().top,this.touch.sh=this.hslider.position().left,this.sliders.stop().fadeTo(this.settings.sliderOpacityTime,1),i.stopPropagation()}),this.bindEvent(this.container,"touchmove",function(t){var i=t.originalEvent,s=i.targetTouches[0];this.scroll(this.touch.sv+(this.touch.sy-s.pageY)*this.settings.touchSpeed,this.touch.sh+(this.touch.sx-s.pageX)*this.settings.touchSpeed),i.preventDefault(),i.stopPropagation()}),this.bindEvent(this.container,"touchend touchcancel",function(t){var i=t.originalEvent;i.changedTouches[0];this.sliders.stop().fadeTo(this.settings.sliderOpacityTime,this.settings.sliderOpacity),i.stopPropagation()});var t=this.vpath.height(),i=this.hpath.width();this.bindEvent(r(window),"resize",function(){this.pathSize(),this.checkScroll(),this.vdiff<=0&&this.content.css("top",0),this.hdiff<=0&&this.content.css("left",0),this.scroll(Math.round(parseInt(this.vslider.css("top"),10)*this.vpath.height()/t),Math.round(parseInt(this.hslider.css("left"),10)*this.hpath.width()/i)),t=this.vpath.height(),i=this.hpath.width()}),this.bindEvent(this.container,"mousewheel",function(t,i,s,e){this.scroll(this.vslider.position().top-this.settings.wheelSpeed*e,this.hslider.position().left+this.settings.wheelSpeed*s,t),this.sliders.stop().fadeTo(this.settings.sliderOpacityTime,1),window.clearTimeout(this.timer),this.timer=window.setTimeout(this.fixFn(function(){this.sliders.stop().fadeTo(this.settings.sliderOpacityTime,this.settings.sliderOpacity)}),this.settings.sliderOpacityDelay),this.settings.blockGlobalScroll&&(this.vdiff||this.hdiff)&&(t.preventDefault(),t.stopPropagation())}),this.bindEvent(n,"keydown",function(t){var i=0,s=0;s=38==t.keyCode?-this.settings.keyScroll:s,s=40==t.keyCode?this.settings.keyScroll:s,i=37==t.keyCode?-this.settings.keyScroll:i,i=39==t.keyCode?this.settings.keyScroll:i,(s||i)&&this.easeScroll(s,i)}),this.bindEvent(this.container,"uscrollbar",function(t,i,s,e){"reset"!==i?(i=i||0,s=s||0,t.stopPropagation(),/^[-\d\.]+$/.test(i)&&(i=parseFloat(i),Math.abs(i)<=1&&!e?i*=this.vtrack:i+=i*(this.vtrack/this.vdiff-1)),/^[-\d\.]+$/.test(s)&&(s=parseFloat(s),Math.abs(s)<=1&&!e?s*=this.htrack:s+=s*(this.htrack/this.hdiff-1)),this.easeScroll(i,s)):this.container.find(".scrollbar-content, .scrollbar-handle").stop().css({top:0,left:0})})},r.fn.ClassyScroll=function(t){var i={scroll:"both",autoHide:!0,autoHideTime:"fast",lazyCheckScroll:1e3,blockGlobalScroll:!1,contentFilter:"*",sliderSize:"30%",sliderOpacity:.5,sliderOpacityTime:200,sliderOpacityDelay:1e3,wheelSpeed:20,touchSpeed:.3,pathPadding:"20px",keyScroll:100,scrollTime:500,scrollInterval:15,scrollEasing:"swing",zIndex:100,onscroll:function(){}};return r.extend(i,t),this.each(function(){new s(this,i)})}}(jQuery);